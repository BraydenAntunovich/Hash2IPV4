using System.Diagnostics;

public class MD5toIPV4
{
    private readonly string hashcatDir;
    private readonly string hashcatExecutablePath;
    private readonly string potfilePath;
    private readonly string maskPatternsPath;
    private Process? hashcatProcess = null;

    public MD5toIPV4(string hashcatDir)
    {
        this.hashcatDir = hashcatDir; // Extract hashcat binaries to this directory, download: https://hashcat.net/hashcat/
        this.hashcatExecutablePath = Path.Combine(hashcatDir, "hashcat.exe");
        this.potfilePath = Path.Combine(hashcatDir, "hashcat.potfile");
        this.maskPatternsPath = Path.Combine(Directory.GetCurrentDirectory(), "ipv4.hcmask");
        GenerateMaskPatternsFile();
        AppDomain.CurrentDomain.ProcessExit += (sender, e) => KillHashcatProcess();
        Console.CancelKeyPress += (sender, e) => KillHashcatProcess();
    }

    private void KillHashcatProcess()
    {
        if (hashcatProcess != null && !hashcatProcess.HasExited)
        {
            hashcatProcess.Kill();
            hashcatProcess = null;
        }
    }

    private void GenerateMaskPatternsFile()
    {
        // Cheers johnjohnsp1 https://github.com/johnjohnsp1/hexhosts/blob/master/ipv4.hcmask
        var patterns = new List<string>
        {
            "01234,012345,123456789,1?d?d.1?d?d.1?d?d.1?d?d",
            "01234,012345,123456789,1?d?d.1?d?d.1?d?d.2?1?d",
            "01234,012345,123456789,1?d?d.1?d?d.1?d?d.25?2",
            "01234,012345,123456789,1?d?d.1?d?d.1?d?d.?3?d",
            "01234,012345,123456789,1?d?d.1?d?d.1?d?d.?d",
            "01234,012345,123456789,1?d?d.1?d?d.2?1?d.1?d?d",
            "01234,012345,123456789,1?d?d.1?d?d.2?1?d.2?1?d",
            "01234,012345,123456789,1?d?d.1?d?d.2?1?d.25?2",
            "01234,012345,123456789,1?d?d.1?d?d.2?1?d.?3?d",
            "01234,012345,123456789,1?d?d.1?d?d.2?1?d.?d",
            "01234,012345,123456789,1?d?d.1?d?d.25?2.1?d?d",
            "01234,012345,123456789,1?d?d.1?d?d.25?2.2?1?d",
            "01234,012345,123456789,1?d?d.1?d?d.25?2.25?2",
            "01234,012345,123456789,1?d?d.1?d?d.25?2.?3?d",
            "01234,012345,123456789,1?d?d.1?d?d.25?2.?d",
            "01234,012345,123456789,1?d?d.1?d?d.?3?d.1?d?d",
            "01234,012345,123456789,1?d?d.1?d?d.?3?d.2?1?d",
            "01234,012345,123456789,1?d?d.1?d?d.?3?d.25?2",
            "01234,012345,123456789,1?d?d.1?d?d.?3?d.?3?d",
            "01234,012345,123456789,1?d?d.1?d?d.?3?d.?d",
            "01234,012345,123456789,1?d?d.1?d?d.?d.1?d?d",
            "01234,012345,123456789,1?d?d.1?d?d.?d.2?1?d",
            "01234,012345,123456789,1?d?d.1?d?d.?d.25?2",
            "01234,012345,123456789,1?d?d.1?d?d.?d.?3?d",
            "01234,012345,123456789,1?d?d.1?d?d.?d.?d",
            "01234,012345,123456789,1?d?d.2?1?d.1?d?d.1?d?d",
            "01234,012345,123456789,1?d?d.2?1?d.1?d?d.2?1?d",
            "01234,012345,123456789,1?d?d.2?1?d.1?d?d.25?2",
            "01234,012345,123456789,1?d?d.2?1?d.1?d?d.?3?d",
            "01234,012345,123456789,1?d?d.2?1?d.1?d?d.?d",
            "01234,012345,123456789,1?d?d.2?1?d.2?1?d.1?d?d",
            "01234,012345,123456789,1?d?d.2?1?d.2?1?d.2?1?d",
            "01234,012345,123456789,1?d?d.2?1?d.2?1?d.25?2",
            "01234,012345,123456789,1?d?d.2?1?d.2?1?d.?3?d",
            "01234,012345,123456789,1?d?d.2?1?d.2?1?d.?d",
            "01234,012345,123456789,1?d?d.2?1?d.25?2.1?d?d",
            "01234,012345,123456789,1?d?d.2?1?d.25?2.2?1?d",
            "01234,012345,123456789,1?d?d.2?1?d.25?2.25?2",
            "01234,012345,123456789,1?d?d.2?1?d.25?2.?3?d",
            "01234,012345,123456789,1?d?d.2?1?d.25?2.?d",
            "01234,012345,123456789,1?d?d.2?1?d.?3?d.1?d?d",
            "01234,012345,123456789,1?d?d.2?1?d.?3?d.2?1?d",
            "01234,012345,123456789,1?d?d.2?1?d.?3?d.25?2",
            "01234,012345,123456789,1?d?d.2?1?d.?3?d.?3?d",
            "01234,012345,123456789,1?d?d.2?1?d.?3?d.?d",
            "01234,012345,123456789,1?d?d.2?1?d.?d.1?d?d",
            "01234,012345,123456789,1?d?d.2?1?d.?d.2?1?d",
            "01234,012345,123456789,1?d?d.2?1?d.?d.25?2",
            "01234,012345,123456789,1?d?d.2?1?d.?d.?3?d",
            "01234,012345,123456789,1?d?d.2?1?d.?d.?d",
            "01234,012345,123456789,1?d?d.25?2.1?d?d.1?d?d",
            "01234,012345,123456789,1?d?d.25?2.1?d?d.2?1?d",
            "01234,012345,123456789,1?d?d.25?2.1?d?d.25?2",
            "01234,012345,123456789,1?d?d.25?2.1?d?d.?3?d",
            "01234,012345,123456789,1?d?d.25?2.1?d?d.?d",
            "01234,012345,123456789,1?d?d.25?2.2?1?d.1?d?d",
            "01234,012345,123456789,1?d?d.25?2.2?1?d.2?1?d",
            "01234,012345,123456789,1?d?d.25?2.2?1?d.25?2",
            "01234,012345,123456789,1?d?d.25?2.2?1?d.?3?d",
            "01234,012345,123456789,1?d?d.25?2.2?1?d.?d",
            "01234,012345,123456789,1?d?d.25?2.25?2.1?d?d",
            "01234,012345,123456789,1?d?d.25?2.25?2.2?1?d",
            "01234,012345,123456789,1?d?d.25?2.25?2.25?2",
            "01234,012345,123456789,1?d?d.25?2.25?2.?3?d",
            "01234,012345,123456789,1?d?d.25?2.25?2.?d",
            "01234,012345,123456789,1?d?d.25?2.?3?d.1?d?d",
            "01234,012345,123456789,1?d?d.25?2.?3?d.2?1?d",
            "01234,012345,123456789,1?d?d.25?2.?3?d.25?2",
            "01234,012345,123456789,1?d?d.25?2.?3?d.?3?d",
            "01234,012345,123456789,1?d?d.25?2.?3?d.?d",
            "01234,012345,123456789,1?d?d.25?2.?d.1?d?d",
            "01234,012345,123456789,1?d?d.25?2.?d.2?1?d",
            "01234,012345,123456789,1?d?d.25?2.?d.25?2",
            "01234,012345,123456789,1?d?d.25?2.?d.?3?d",
            "01234,012345,123456789,1?d?d.25?2.?d.?d",
            "01234,012345,123456789,1?d?d.?3?d.1?d?d.1?d?d",
            "01234,012345,123456789,1?d?d.?3?d.1?d?d.2?1?d",
            "01234,012345,123456789,1?d?d.?3?d.1?d?d.25?2",
            "01234,012345,123456789,1?d?d.?3?d.1?d?d.?3?d",
            "01234,012345,123456789,1?d?d.?3?d.1?d?d.?d",
            "01234,012345,123456789,1?d?d.?3?d.2?1?d.1?d?d",
            "01234,012345,123456789,1?d?d.?3?d.2?1?d.2?1?d",
            "01234,012345,123456789,1?d?d.?3?d.2?1?d.25?2",
            "01234,012345,123456789,1?d?d.?3?d.2?1?d.?3?d",
            "01234,012345,123456789,1?d?d.?3?d.2?1?d.?d",
            "01234,012345,123456789,1?d?d.?3?d.25?2.1?d?d",
            "01234,012345,123456789,1?d?d.?3?d.25?2.2?1?d",
            "01234,012345,123456789,1?d?d.?3?d.25?2.25?2",
            "01234,012345,123456789,1?d?d.?3?d.25?2.?3?d",
            "01234,012345,123456789,1?d?d.?3?d.25?2.?d",
            "01234,012345,123456789,1?d?d.?3?d.?3?d.1?d?d",
            "01234,012345,123456789,1?d?d.?3?d.?3?d.2?1?d",
            "01234,012345,123456789,1?d?d.?3?d.?3?d.25?2",
            "01234,012345,123456789,1?d?d.?3?d.?3?d.?3?d",
            "01234,012345,123456789,1?d?d.?3?d.?3?d.?d",
            "01234,012345,123456789,1?d?d.?3?d.?d.1?d?d",
            "01234,012345,123456789,1?d?d.?3?d.?d.2?1?d",
            "01234,012345,123456789,1?d?d.?3?d.?d.25?2",
            "01234,012345,123456789,1?d?d.?3?d.?d.?3?d",
            "01234,012345,123456789,1?d?d.?3?d.?d.?d",
            "01234,012345,123456789,1?d?d.?d.1?d?d.1?d?d",
            "01234,012345,123456789,1?d?d.?d.1?d?d.2?1?d",
            "01234,012345,123456789,1?d?d.?d.1?d?d.25?2",
            "01234,012345,123456789,1?d?d.?d.1?d?d.?3?d",
            "01234,012345,123456789,1?d?d.?d.1?d?d.?d",
            "01234,012345,123456789,1?d?d.?d.2?1?d.1?d?d",
            "01234,012345,123456789,1?d?d.?d.2?1?d.2?1?d",
            "01234,012345,123456789,1?d?d.?d.2?1?d.25?2",
            "01234,012345,123456789,1?d?d.?d.2?1?d.?3?d",
            "01234,012345,123456789,1?d?d.?d.2?1?d.?d",
            "01234,012345,123456789,1?d?d.?d.25?2.1?d?d",
            "01234,012345,123456789,1?d?d.?d.25?2.2?1?d",
            "01234,012345,123456789,1?d?d.?d.25?2.25?2",
            "01234,012345,123456789,1?d?d.?d.25?2.?3?d",
            "01234,012345,123456789,1?d?d.?d.25?2.?d",
            "01234,012345,123456789,1?d?d.?d.?3?d.1?d?d",
            "01234,012345,123456789,1?d?d.?d.?3?d.2?1?d",
            "01234,012345,123456789,1?d?d.?d.?3?d.25?2",
            "01234,012345,123456789,1?d?d.?d.?3?d.?3?d",
            "01234,012345,123456789,1?d?d.?d.?3?d.?d",
            "01234,012345,123456789,1?d?d.?d.?d.1?d?d",
            "01234,012345,123456789,1?d?d.?d.?d.2?1?d",
            "01234,012345,123456789,1?d?d.?d.?d.25?2",
            "01234,012345,123456789,1?d?d.?d.?d.?3?d",
            "01234,012345,123456789,1?d?d.?d.?d.?d",
            "01234,012345,123456789,2?1?d.1?d?d.1?d?d.1?d?d",
            "01234,012345,123456789,2?1?d.1?d?d.1?d?d.2?1?d",
            "01234,012345,123456789,2?1?d.1?d?d.1?d?d.25?2",
            "01234,012345,123456789,2?1?d.1?d?d.1?d?d.?3?d",
            "01234,012345,123456789,2?1?d.1?d?d.1?d?d.?d",
            "01234,012345,123456789,2?1?d.1?d?d.2?1?d.1?d?d",
            "01234,012345,123456789,2?1?d.1?d?d.2?1?d.2?1?d",
            "01234,012345,123456789,2?1?d.1?d?d.2?1?d.25?2",
            "01234,012345,123456789,2?1?d.1?d?d.2?1?d.?3?d",
            "01234,012345,123456789,2?1?d.1?d?d.2?1?d.?d",
            "01234,012345,123456789,2?1?d.1?d?d.25?2.1?d?d",
            "01234,012345,123456789,2?1?d.1?d?d.25?2.2?1?d",
            "01234,012345,123456789,2?1?d.1?d?d.25?2.25?2",
            "01234,012345,123456789,2?1?d.1?d?d.25?2.?3?d",
            "01234,012345,123456789,2?1?d.1?d?d.25?2.?d",
            "01234,012345,123456789,2?1?d.1?d?d.?3?d.1?d?d",
            "01234,012345,123456789,2?1?d.1?d?d.?3?d.2?1?d",
            "01234,012345,123456789,2?1?d.1?d?d.?3?d.25?2",
            "01234,012345,123456789,2?1?d.1?d?d.?3?d.?3?d",
            "01234,012345,123456789,2?1?d.1?d?d.?3?d.?d",
            "01234,012345,123456789,2?1?d.1?d?d.?d.1?d?d",
            "01234,012345,123456789,2?1?d.1?d?d.?d.2?1?d",
            "01234,012345,123456789,2?1?d.1?d?d.?d.25?2",
            "01234,012345,123456789,2?1?d.1?d?d.?d.?3?d",
            "01234,012345,123456789,2?1?d.1?d?d.?d.?d",
            "01234,012345,123456789,2?1?d.2?1?d.1?d?d.1?d?d",
            "01234,012345,123456789,2?1?d.2?1?d.1?d?d.2?1?d",
            "01234,012345,123456789,2?1?d.2?1?d.1?d?d.25?2",
            "01234,012345,123456789,2?1?d.2?1?d.1?d?d.?3?d",
            "01234,012345,123456789,2?1?d.2?1?d.1?d?d.?d",
            "01234,012345,123456789,2?1?d.2?1?d.2?1?d.1?d?d",
            "01234,012345,123456789,2?1?d.2?1?d.2?1?d.2?1?d",
            "01234,012345,123456789,2?1?d.2?1?d.2?1?d.25?2",
            "01234,012345,123456789,2?1?d.2?1?d.2?1?d.?3?d",
            "01234,012345,123456789,2?1?d.2?1?d.2?1?d.?d",
            "01234,012345,123456789,2?1?d.2?1?d.25?2.1?d?d",
            "01234,012345,123456789,2?1?d.2?1?d.25?2.2?1?d",
            "01234,012345,123456789,2?1?d.2?1?d.25?2.25?2",
            "01234,012345,123456789,2?1?d.2?1?d.25?2.?3?d",
            "01234,012345,123456789,2?1?d.2?1?d.25?2.?d",
            "01234,012345,123456789,2?1?d.2?1?d.?3?d.1?d?d",
            "01234,012345,123456789,2?1?d.2?1?d.?3?d.2?1?d",
            "01234,012345,123456789,2?1?d.2?1?d.?3?d.25?2",
            "01234,012345,123456789,2?1?d.2?1?d.?3?d.?3?d",
            "01234,012345,123456789,2?1?d.2?1?d.?3?d.?d",
            "01234,012345,123456789,2?1?d.2?1?d.?d.1?d?d",
            "01234,012345,123456789,2?1?d.2?1?d.?d.2?1?d",
            "01234,012345,123456789,2?1?d.2?1?d.?d.25?2",
            "01234,012345,123456789,2?1?d.2?1?d.?d.?3?d",
            "01234,012345,123456789,2?1?d.2?1?d.?d.?d",
            "01234,012345,123456789,2?1?d.25?2.1?d?d.1?d?d",
            "01234,012345,123456789,2?1?d.25?2.1?d?d.2?1?d",
            "01234,012345,123456789,2?1?d.25?2.1?d?d.25?2",
            "01234,012345,123456789,2?1?d.25?2.1?d?d.?3?d",
            "01234,012345,123456789,2?1?d.25?2.1?d?d.?d",
            "01234,012345,123456789,2?1?d.25?2.2?1?d.1?d?d",
            "01234,012345,123456789,2?1?d.25?2.2?1?d.2?1?d",
            "01234,012345,123456789,2?1?d.25?2.2?1?d.25?2",
            "01234,012345,123456789,2?1?d.25?2.2?1?d.?3?d",
            "01234,012345,123456789,2?1?d.25?2.2?1?d.?d",
            "01234,012345,123456789,2?1?d.25?2.25?2.1?d?d",
            "01234,012345,123456789,2?1?d.25?2.25?2.2?1?d",
            "01234,012345,123456789,2?1?d.25?2.25?2.25?2",
            "01234,012345,123456789,2?1?d.25?2.25?2.?3?d",
            "01234,012345,123456789,2?1?d.25?2.25?2.?d",
            "01234,012345,123456789,2?1?d.25?2.?3?d.1?d?d",
            "01234,012345,123456789,2?1?d.25?2.?3?d.2?1?d",
            "01234,012345,123456789,2?1?d.25?2.?3?d.25?2",
            "01234,012345,123456789,2?1?d.25?2.?3?d.?3?d",
            "01234,012345,123456789,2?1?d.25?2.?3?d.?d",
            "01234,012345,123456789,2?1?d.25?2.?d.1?d?d",
            "01234,012345,123456789,2?1?d.25?2.?d.2?1?d",
            "01234,012345,123456789,2?1?d.25?2.?d.25?2",
            "01234,012345,123456789,2?1?d.25?2.?d.?3?d",
            "01234,012345,123456789,2?1?d.25?2.?d.?d",
            "01234,012345,123456789,2?1?d.?3?d.1?d?d.1?d?d",
            "01234,012345,123456789,2?1?d.?3?d.1?d?d.2?1?d",
            "01234,012345,123456789,2?1?d.?3?d.1?d?d.25?2",
            "01234,012345,123456789,2?1?d.?3?d.1?d?d.?3?d",
            "01234,012345,123456789,2?1?d.?3?d.1?d?d.?d",
            "01234,012345,123456789,2?1?d.?3?d.2?1?d.1?d?d",
            "01234,012345,123456789,2?1?d.?3?d.2?1?d.2?1?d",
            "01234,012345,123456789,2?1?d.?3?d.2?1?d.25?2",
            "01234,012345,123456789,2?1?d.?3?d.2?1?d.?3?d",
            "01234,012345,123456789,2?1?d.?3?d.2?1?d.?d",
            "01234,012345,123456789,2?1?d.?3?d.25?2.1?d?d",
            "01234,012345,123456789,2?1?d.?3?d.25?2.2?1?d",
            "01234,012345,123456789,2?1?d.?3?d.25?2.25?2",
            "01234,012345,123456789,2?1?d.?3?d.25?2.?3?d",
            "01234,012345,123456789,2?1?d.?3?d.25?2.?d",
            "01234,012345,123456789,2?1?d.?3?d.?3?d.1?d?d",
            "01234,012345,123456789,2?1?d.?3?d.?3?d.2?1?d",
            "01234,012345,123456789,2?1?d.?3?d.?3?d.25?2",
            "01234,012345,123456789,2?1?d.?3?d.?3?d.?3?d",
            "01234,012345,123456789,2?1?d.?3?d.?3?d.?d",
            "01234,012345,123456789,2?1?d.?3?d.?d.1?d?d",
            "01234,012345,123456789,2?1?d.?3?d.?d.2?1?d",
            "01234,012345,123456789,2?1?d.?3?d.?d.25?2",
            "01234,012345,123456789,2?1?d.?3?d.?d.?3?d",
            "01234,012345,123456789,2?1?d.?3?d.?d.?d",
            "01234,012345,123456789,2?1?d.?d.1?d?d.1?d?d",
            "01234,012345,123456789,2?1?d.?d.1?d?d.2?1?d",
            "01234,012345,123456789,2?1?d.?d.1?d?d.25?2",
            "01234,012345,123456789,2?1?d.?d.1?d?d.?3?d",
            "01234,012345,123456789,2?1?d.?d.1?d?d.?d",
            "01234,012345,123456789,2?1?d.?d.2?1?d.1?d?d",
            "01234,012345,123456789,2?1?d.?d.2?1?d.2?1?d",
            "01234,012345,123456789,2?1?d.?d.2?1?d.25?2",
            "01234,012345,123456789,2?1?d.?d.2?1?d.?3?d",
            "01234,012345,123456789,2?1?d.?d.2?1?d.?d",
            "01234,012345,123456789,2?1?d.?d.25?2.1?d?d",
            "01234,012345,123456789,2?1?d.?d.25?2.2?1?d",
            "01234,012345,123456789,2?1?d.?d.25?2.25?2",
            "01234,012345,123456789,2?1?d.?d.25?2.?3?d",
            "01234,012345,123456789,2?1?d.?d.25?2.?d",
            "01234,012345,123456789,2?1?d.?d.?3?d.1?d?d",
            "01234,012345,123456789,2?1?d.?d.?3?d.2?1?d",
            "01234,012345,123456789,2?1?d.?d.?3?d.25?2",
            "01234,012345,123456789,2?1?d.?d.?3?d.?3?d",
            "01234,012345,123456789,2?1?d.?d.?3?d.?d",
            "01234,012345,123456789,2?1?d.?d.?d.1?d?d",
            "01234,012345,123456789,2?1?d.?d.?d.2?1?d",
            "01234,012345,123456789,2?1?d.?d.?d.25?2",
            "01234,012345,123456789,2?1?d.?d.?d.?3?d",
            "01234,012345,123456789,2?1?d.?d.?d.?d",
            "01234,012345,123456789,25?2.1?d?d.1?d?d.1?d?d",
            "01234,012345,123456789,25?2.1?d?d.1?d?d.2?1?d",
            "01234,012345,123456789,25?2.1?d?d.1?d?d.25?2",
            "01234,012345,123456789,25?2.1?d?d.1?d?d.?3?d",
            "01234,012345,123456789,25?2.1?d?d.1?d?d.?d",
            "01234,012345,123456789,25?2.1?d?d.2?1?d.1?d?d",
            "01234,012345,123456789,25?2.1?d?d.2?1?d.2?1?d",
            "01234,012345,123456789,25?2.1?d?d.2?1?d.25?2",
            "01234,012345,123456789,25?2.1?d?d.2?1?d.?3?d",
            "01234,012345,123456789,25?2.1?d?d.2?1?d.?d",
            "01234,012345,123456789,25?2.1?d?d.25?2.1?d?d",
            "01234,012345,123456789,25?2.1?d?d.25?2.2?1?d",
            "01234,012345,123456789,25?2.1?d?d.25?2.25?2",
            "01234,012345,123456789,25?2.1?d?d.25?2.?3?d",
            "01234,012345,123456789,25?2.1?d?d.25?2.?d",
            "01234,012345,123456789,25?2.1?d?d.?3?d.1?d?d",
            "01234,012345,123456789,25?2.1?d?d.?3?d.2?1?d",
            "01234,012345,123456789,25?2.1?d?d.?3?d.25?2",
            "01234,012345,123456789,25?2.1?d?d.?3?d.?3?d",
            "01234,012345,123456789,25?2.1?d?d.?3?d.?d",
            "01234,012345,123456789,25?2.1?d?d.?d.1?d?d",
            "01234,012345,123456789,25?2.1?d?d.?d.2?1?d",
            "01234,012345,123456789,25?2.1?d?d.?d.25?2",
            "01234,012345,123456789,25?2.1?d?d.?d.?3?d",
            "01234,012345,123456789,25?2.1?d?d.?d.?d",
            "01234,012345,123456789,25?2.2?1?d.1?d?d.1?d?d",
            "01234,012345,123456789,25?2.2?1?d.1?d?d.2?1?d",
            "01234,012345,123456789,25?2.2?1?d.1?d?d.25?2",
            "01234,012345,123456789,25?2.2?1?d.1?d?d.?3?d",
            "01234,012345,123456789,25?2.2?1?d.1?d?d.?d",
            "01234,012345,123456789,25?2.2?1?d.2?1?d.1?d?d",
            "01234,012345,123456789,25?2.2?1?d.2?1?d.2?1?d",
            "01234,012345,123456789,25?2.2?1?d.2?1?d.25?2",
            "01234,012345,123456789,25?2.2?1?d.2?1?d.?3?d",
            "01234,012345,123456789,25?2.2?1?d.2?1?d.?d",
            "01234,012345,123456789,25?2.2?1?d.25?2.1?d?d",
            "01234,012345,123456789,25?2.2?1?d.25?2.2?1?d",
            "01234,012345,123456789,25?2.2?1?d.25?2.25?2",
            "01234,012345,123456789,25?2.2?1?d.25?2.?3?d",
            "01234,012345,123456789,25?2.2?1?d.25?2.?d",
            "01234,012345,123456789,25?2.2?1?d.?3?d.1?d?d",
            "01234,012345,123456789,25?2.2?1?d.?3?d.2?1?d",
            "01234,012345,123456789,25?2.2?1?d.?3?d.25?2",
            "01234,012345,123456789,25?2.2?1?d.?3?d.?3?d",
            "01234,012345,123456789,25?2.2?1?d.?3?d.?d",
            "01234,012345,123456789,25?2.2?1?d.?d.1?d?d",
            "01234,012345,123456789,25?2.2?1?d.?d.2?1?d",
            "01234,012345,123456789,25?2.2?1?d.?d.25?2",
            "01234,012345,123456789,25?2.2?1?d.?d.?3?d",
            "01234,012345,123456789,25?2.2?1?d.?d.?d",
            "01234,012345,123456789,25?2.25?2.1?d?d.1?d?d",
            "01234,012345,123456789,25?2.25?2.1?d?d.2?1?d",
            "01234,012345,123456789,25?2.25?2.1?d?d.25?2",
            "01234,012345,123456789,25?2.25?2.1?d?d.?3?d",
            "01234,012345,123456789,25?2.25?2.1?d?d.?d",
            "01234,012345,123456789,25?2.25?2.2?1?d.1?d?d",
            "01234,012345,123456789,25?2.25?2.2?1?d.2?1?d",
            "01234,012345,123456789,25?2.25?2.2?1?d.25?2",
            "01234,012345,123456789,25?2.25?2.2?1?d.?3?d",
            "01234,012345,123456789,25?2.25?2.2?1?d.?d",
            "01234,012345,123456789,25?2.25?2.25?2.1?d?d",
            "01234,012345,123456789,25?2.25?2.25?2.2?1?d",
            "01234,012345,123456789,25?2.25?2.25?2.25?2",
            "01234,012345,123456789,25?2.25?2.25?2.?3?d",
            "01234,012345,123456789,25?2.25?2.25?2.?d",
            "01234,012345,123456789,25?2.25?2.?3?d.1?d?d",
            "01234,012345,123456789,25?2.25?2.?3?d.2?1?d",
            "01234,012345,123456789,25?2.25?2.?3?d.25?2",
            "01234,012345,123456789,25?2.25?2.?3?d.?3?d",
            "01234,012345,123456789,25?2.25?2.?3?d.?d",
            "01234,012345,123456789,25?2.25?2.?d.1?d?d",
            "01234,012345,123456789,25?2.25?2.?d.2?1?d",
            "01234,012345,123456789,25?2.25?2.?d.25?2",
            "01234,012345,123456789,25?2.25?2.?d.?3?d",
            "01234,012345,123456789,25?2.25?2.?d.?d",
            "01234,012345,123456789,25?2.?3?d.1?d?d.1?d?d",
            "01234,012345,123456789,25?2.?3?d.1?d?d.2?1?d",
            "01234,012345,123456789,25?2.?3?d.1?d?d.25?2",
            "01234,012345,123456789,25?2.?3?d.1?d?d.?3?d",
            "01234,012345,123456789,25?2.?3?d.1?d?d.?d",
            "01234,012345,123456789,25?2.?3?d.2?1?d.1?d?d",
            "01234,012345,123456789,25?2.?3?d.2?1?d.2?1?d",
            "01234,012345,123456789,25?2.?3?d.2?1?d.25?2",
            "01234,012345,123456789,25?2.?3?d.2?1?d.?3?d",
            "01234,012345,123456789,25?2.?3?d.2?1?d.?d",
            "01234,012345,123456789,25?2.?3?d.25?2.1?d?d",
            "01234,012345,123456789,25?2.?3?d.25?2.2?1?d",
            "01234,012345,123456789,25?2.?3?d.25?2.25?2",
            "01234,012345,123456789,25?2.?3?d.25?2.?3?d",
            "01234,012345,123456789,25?2.?3?d.25?2.?d",
            "01234,012345,123456789,25?2.?3?d.?3?d.1?d?d",
            "01234,012345,123456789,25?2.?3?d.?3?d.2?1?d",
            "01234,012345,123456789,25?2.?3?d.?3?d.25?2",
            "01234,012345,123456789,25?2.?3?d.?3?d.?3?d",
            "01234,012345,123456789,25?2.?3?d.?3?d.?d",
            "01234,012345,123456789,25?2.?3?d.?d.1?d?d",
            "01234,012345,123456789,25?2.?3?d.?d.2?1?d",
            "01234,012345,123456789,25?2.?3?d.?d.25?2",
            "01234,012345,123456789,25?2.?3?d.?d.?3?d",
            "01234,012345,123456789,25?2.?3?d.?d.?d",
            "01234,012345,123456789,25?2.?d.1?d?d.1?d?d",
            "01234,012345,123456789,25?2.?d.1?d?d.2?1?d",
            "01234,012345,123456789,25?2.?d.1?d?d.25?2",
            "01234,012345,123456789,25?2.?d.1?d?d.?3?d",
            "01234,012345,123456789,25?2.?d.1?d?d.?d",
            "01234,012345,123456789,25?2.?d.2?1?d.1?d?d",
            "01234,012345,123456789,25?2.?d.2?1?d.2?1?d",
            "01234,012345,123456789,25?2.?d.2?1?d.25?2",
            "01234,012345,123456789,25?2.?d.2?1?d.?3?d",
            "01234,012345,123456789,25?2.?d.2?1?d.?d",
            "01234,012345,123456789,25?2.?d.25?2.1?d?d",
            "01234,012345,123456789,25?2.?d.25?2.2?1?d",
            "01234,012345,123456789,25?2.?d.25?2.25?2",
            "01234,012345,123456789,25?2.?d.25?2.?3?d",
            "01234,012345,123456789,25?2.?d.25?2.?d",
            "01234,012345,123456789,25?2.?d.?3?d.1?d?d",
            "01234,012345,123456789,25?2.?d.?3?d.2?1?d",
            "01234,012345,123456789,25?2.?d.?3?d.25?2",
            "01234,012345,123456789,25?2.?d.?3?d.?3?d",
            "01234,012345,123456789,25?2.?d.?3?d.?d",
            "01234,012345,123456789,25?2.?d.?d.1?d?d",
            "01234,012345,123456789,25?2.?d.?d.2?1?d",
            "01234,012345,123456789,25?2.?d.?d.25?2",
            "01234,012345,123456789,25?2.?d.?d.?3?d",
            "01234,012345,123456789,25?2.?d.?d.?d",
            "01234,012345,123456789,?3?d.1?d?d.1?d?d.1?d?d",
            "01234,012345,123456789,?3?d.1?d?d.1?d?d.2?1?d",
            "01234,012345,123456789,?3?d.1?d?d.1?d?d.25?2",
            "01234,012345,123456789,?3?d.1?d?d.1?d?d.?3?d",
            "01234,012345,123456789,?3?d.1?d?d.1?d?d.?d",
            "01234,012345,123456789,?3?d.1?d?d.2?1?d.1?d?d",
            "01234,012345,123456789,?3?d.1?d?d.2?1?d.2?1?d",
            "01234,012345,123456789,?3?d.1?d?d.2?1?d.25?2",
            "01234,012345,123456789,?3?d.1?d?d.2?1?d.?3?d",
            "01234,012345,123456789,?3?d.1?d?d.2?1?d.?d",
            "01234,012345,123456789,?3?d.1?d?d.25?2.1?d?d",
            "01234,012345,123456789,?3?d.1?d?d.25?2.2?1?d",
            "01234,012345,123456789,?3?d.1?d?d.25?2.25?2",
            "01234,012345,123456789,?3?d.1?d?d.25?2.?3?d",
            "01234,012345,123456789,?3?d.1?d?d.25?2.?d",
            "01234,012345,123456789,?3?d.1?d?d.?3?d.1?d?d",
            "01234,012345,123456789,?3?d.1?d?d.?3?d.2?1?d",
            "01234,012345,123456789,?3?d.1?d?d.?3?d.25?2",
            "01234,012345,123456789,?3?d.1?d?d.?3?d.?3?d",
            "01234,012345,123456789,?3?d.1?d?d.?3?d.?d",
            "01234,012345,123456789,?3?d.1?d?d.?d.1?d?d",
            "01234,012345,123456789,?3?d.1?d?d.?d.2?1?d",
            "01234,012345,123456789,?3?d.1?d?d.?d.25?2",
            "01234,012345,123456789,?3?d.1?d?d.?d.?3?d",
            "01234,012345,123456789,?3?d.1?d?d.?d.?d",
            "01234,012345,123456789,?3?d.2?1?d.1?d?d.1?d?d",
            "01234,012345,123456789,?3?d.2?1?d.1?d?d.2?1?d",
            "01234,012345,123456789,?3?d.2?1?d.1?d?d.25?2",
            "01234,012345,123456789,?3?d.2?1?d.1?d?d.?3?d",
            "01234,012345,123456789,?3?d.2?1?d.1?d?d.?d",
            "01234,012345,123456789,?3?d.2?1?d.2?1?d.1?d?d",
            "01234,012345,123456789,?3?d.2?1?d.2?1?d.2?1?d",
            "01234,012345,123456789,?3?d.2?1?d.2?1?d.25?2",
            "01234,012345,123456789,?3?d.2?1?d.2?1?d.?3?d",
            "01234,012345,123456789,?3?d.2?1?d.2?1?d.?d",
            "01234,012345,123456789,?3?d.2?1?d.25?2.1?d?d",
            "01234,012345,123456789,?3?d.2?1?d.25?2.2?1?d",
            "01234,012345,123456789,?3?d.2?1?d.25?2.25?2",
            "01234,012345,123456789,?3?d.2?1?d.25?2.?3?d",
            "01234,012345,123456789,?3?d.2?1?d.25?2.?d",
            "01234,012345,123456789,?3?d.2?1?d.?3?d.1?d?d",
            "01234,012345,123456789,?3?d.2?1?d.?3?d.2?1?d",
            "01234,012345,123456789,?3?d.2?1?d.?3?d.25?2",
            "01234,012345,123456789,?3?d.2?1?d.?3?d.?3?d",
            "01234,012345,123456789,?3?d.2?1?d.?3?d.?d",
            "01234,012345,123456789,?3?d.2?1?d.?d.1?d?d",
            "01234,012345,123456789,?3?d.2?1?d.?d.2?1?d",
            "01234,012345,123456789,?3?d.2?1?d.?d.25?2",
            "01234,012345,123456789,?3?d.2?1?d.?d.?3?d",
            "01234,012345,123456789,?3?d.2?1?d.?d.?d",
            "01234,012345,123456789,?3?d.25?2.1?d?d.1?d?d",
            "01234,012345,123456789,?3?d.25?2.1?d?d.2?1?d",
            "01234,012345,123456789,?3?d.25?2.1?d?d.25?2",
            "01234,012345,123456789,?3?d.25?2.1?d?d.?3?d",
            "01234,012345,123456789,?3?d.25?2.1?d?d.?d",
            "01234,012345,123456789,?3?d.25?2.2?1?d.1?d?d",
            "01234,012345,123456789,?3?d.25?2.2?1?d.2?1?d",
            "01234,012345,123456789,?3?d.25?2.2?1?d.25?2",
            "01234,012345,123456789,?3?d.25?2.2?1?d.?3?d",
            "01234,012345,123456789,?3?d.25?2.2?1?d.?d",
            "01234,012345,123456789,?3?d.25?2.25?2.1?d?d",
            "01234,012345,123456789,?3?d.25?2.25?2.2?1?d",
            "01234,012345,123456789,?3?d.25?2.25?2.25?2",
            "01234,012345,123456789,?3?d.25?2.25?2.?3?d",
            "01234,012345,123456789,?3?d.25?2.25?2.?d",
            "01234,012345,123456789,?3?d.25?2.?3?d.1?d?d",
            "01234,012345,123456789,?3?d.25?2.?3?d.2?1?d",
            "01234,012345,123456789,?3?d.25?2.?3?d.25?2",
            "01234,012345,123456789,?3?d.25?2.?3?d.?3?d",
            "01234,012345,123456789,?3?d.25?2.?3?d.?d",
            "01234,012345,123456789,?3?d.25?2.?d.1?d?d",
            "01234,012345,123456789,?3?d.25?2.?d.2?1?d",
            "01234,012345,123456789,?3?d.25?2.?d.25?2",
            "01234,012345,123456789,?3?d.25?2.?d.?3?d",
            "01234,012345,123456789,?3?d.25?2.?d.?d",
            "01234,012345,123456789,?3?d.?3?d.1?d?d.1?d?d",
            "01234,012345,123456789,?3?d.?3?d.1?d?d.2?1?d",
            "01234,012345,123456789,?3?d.?3?d.1?d?d.25?2",
            "01234,012345,123456789,?3?d.?3?d.1?d?d.?3?d",
            "01234,012345,123456789,?3?d.?3?d.1?d?d.?d",
            "01234,012345,123456789,?3?d.?3?d.2?1?d.1?d?d",
            "01234,012345,123456789,?3?d.?3?d.2?1?d.2?1?d",
            "01234,012345,123456789,?3?d.?3?d.2?1?d.25?2",
            "01234,012345,123456789,?3?d.?3?d.2?1?d.?3?d",
            "01234,012345,123456789,?3?d.?3?d.2?1?d.?d",
            "01234,012345,123456789,?3?d.?3?d.25?2.1?d?d",
            "01234,012345,123456789,?3?d.?3?d.25?2.2?1?d",
            "01234,012345,123456789,?3?d.?3?d.25?2.25?2",
            "01234,012345,123456789,?3?d.?3?d.25?2.?3?d",
            "01234,012345,123456789,?3?d.?3?d.25?2.?d",
            "01234,012345,123456789,?3?d.?3?d.?3?d.1?d?d",
            "01234,012345,123456789,?3?d.?3?d.?3?d.2?1?d",
            "01234,012345,123456789,?3?d.?3?d.?3?d.25?2",
            "01234,012345,123456789,?3?d.?3?d.?3?d.?3?d",
            "01234,012345,123456789,?3?d.?3?d.?3?d.?d",
            "01234,012345,123456789,?3?d.?3?d.?d.1?d?d",
            "01234,012345,123456789,?3?d.?3?d.?d.2?1?d",
            "01234,012345,123456789,?3?d.?3?d.?d.25?2",
            "01234,012345,123456789,?3?d.?3?d.?d.?3?d",
            "01234,012345,123456789,?3?d.?3?d.?d.?d",
            "01234,012345,123456789,?3?d.?d.1?d?d.1?d?d",
            "01234,012345,123456789,?3?d.?d.1?d?d.2?1?d",
            "01234,012345,123456789,?3?d.?d.1?d?d.25?2",
            "01234,012345,123456789,?3?d.?d.1?d?d.?3?d",
            "01234,012345,123456789,?3?d.?d.1?d?d.?d",
            "01234,012345,123456789,?3?d.?d.2?1?d.1?d?d",
            "01234,012345,123456789,?3?d.?d.2?1?d.2?1?d",
            "01234,012345,123456789,?3?d.?d.2?1?d.25?2",
            "01234,012345,123456789,?3?d.?d.2?1?d.?3?d",
            "01234,012345,123456789,?3?d.?d.2?1?d.?d",
            "01234,012345,123456789,?3?d.?d.25?2.1?d?d",
            "01234,012345,123456789,?3?d.?d.25?2.2?1?d",
            "01234,012345,123456789,?3?d.?d.25?2.25?2",
            "01234,012345,123456789,?3?d.?d.25?2.?3?d",
            "01234,012345,123456789,?3?d.?d.25?2.?d",
            "01234,012345,123456789,?3?d.?d.?3?d.1?d?d",
            "01234,012345,123456789,?3?d.?d.?3?d.2?1?d",
            "01234,012345,123456789,?3?d.?d.?3?d.25?2",
            "01234,012345,123456789,?3?d.?d.?3?d.?3?d",
            "01234,012345,123456789,?3?d.?d.?3?d.?d",
            "01234,012345,123456789,?3?d.?d.?d.1?d?d",
            "01234,012345,123456789,?3?d.?d.?d.2?1?d",
            "01234,012345,123456789,?3?d.?d.?d.25?2",
            "01234,012345,123456789,?3?d.?d.?d.?3?d",
            "01234,012345,123456789,?3?d.?d.?d.?d",
            "01234,012345,123456789,?d.1?d?d.1?d?d.1?d?d",
            "01234,012345,123456789,?d.1?d?d.1?d?d.2?1?d",
            "01234,012345,123456789,?d.1?d?d.1?d?d.25?2",
            "01234,012345,123456789,?d.1?d?d.1?d?d.?3?d",
            "01234,012345,123456789,?d.1?d?d.1?d?d.?d",
            "01234,012345,123456789,?d.1?d?d.2?1?d.1?d?d",
            "01234,012345,123456789,?d.1?d?d.2?1?d.2?1?d",
            "01234,012345,123456789,?d.1?d?d.2?1?d.25?2",
            "01234,012345,123456789,?d.1?d?d.2?1?d.?3?d",
            "01234,012345,123456789,?d.1?d?d.2?1?d.?d",
            "01234,012345,123456789,?d.1?d?d.25?2.1?d?d",
            "01234,012345,123456789,?d.1?d?d.25?2.2?1?d",
            "01234,012345,123456789,?d.1?d?d.25?2.25?2",
            "01234,012345,123456789,?d.1?d?d.25?2.?3?d",
            "01234,012345,123456789,?d.1?d?d.25?2.?d",
            "01234,012345,123456789,?d.1?d?d.?3?d.1?d?d",
            "01234,012345,123456789,?d.1?d?d.?3?d.2?1?d",
            "01234,012345,123456789,?d.1?d?d.?3?d.25?2",
            "01234,012345,123456789,?d.1?d?d.?3?d.?3?d",
            "01234,012345,123456789,?d.1?d?d.?3?d.?d",
            "01234,012345,123456789,?d.1?d?d.?d.1?d?d",
            "01234,012345,123456789,?d.1?d?d.?d.2?1?d",
            "01234,012345,123456789,?d.1?d?d.?d.25?2",
            "01234,012345,123456789,?d.1?d?d.?d.?3?d",
            "01234,012345,123456789,?d.1?d?d.?d.?d",
            "01234,012345,123456789,?d.2?1?d.1?d?d.1?d?d",
            "01234,012345,123456789,?d.2?1?d.1?d?d.2?1?d",
            "01234,012345,123456789,?d.2?1?d.1?d?d.25?2",
            "01234,012345,123456789,?d.2?1?d.1?d?d.?3?d",
            "01234,012345,123456789,?d.2?1?d.1?d?d.?d",
            "01234,012345,123456789,?d.2?1?d.2?1?d.1?d?d",
            "01234,012345,123456789,?d.2?1?d.2?1?d.2?1?d",
            "01234,012345,123456789,?d.2?1?d.2?1?d.25?2",
            "01234,012345,123456789,?d.2?1?d.2?1?d.?3?d",
            "01234,012345,123456789,?d.2?1?d.2?1?d.?d",
            "01234,012345,123456789,?d.2?1?d.25?2.1?d?d",
            "01234,012345,123456789,?d.2?1?d.25?2.2?1?d",
            "01234,012345,123456789,?d.2?1?d.25?2.25?2",
            "01234,012345,123456789,?d.2?1?d.25?2.?3?d",
            "01234,012345,123456789,?d.2?1?d.25?2.?d",
            "01234,012345,123456789,?d.2?1?d.?3?d.1?d?d",
            "01234,012345,123456789,?d.2?1?d.?3?d.2?1?d",
            "01234,012345,123456789,?d.2?1?d.?3?d.25?2",
            "01234,012345,123456789,?d.2?1?d.?3?d.?3?d",
            "01234,012345,123456789,?d.2?1?d.?3?d.?d",
            "01234,012345,123456789,?d.2?1?d.?d.1?d?d",
            "01234,012345,123456789,?d.2?1?d.?d.2?1?d",
            "01234,012345,123456789,?d.2?1?d.?d.25?2",
            "01234,012345,123456789,?d.2?1?d.?d.?3?d",
            "01234,012345,123456789,?d.2?1?d.?d.?d",
            "01234,012345,123456789,?d.25?2.1?d?d.1?d?d",
            "01234,012345,123456789,?d.25?2.1?d?d.2?1?d",
            "01234,012345,123456789,?d.25?2.1?d?d.25?2",
            "01234,012345,123456789,?d.25?2.1?d?d.?3?d",
            "01234,012345,123456789,?d.25?2.1?d?d.?d",
            "01234,012345,123456789,?d.25?2.2?1?d.1?d?d",
            "01234,012345,123456789,?d.25?2.2?1?d.2?1?d",
            "01234,012345,123456789,?d.25?2.2?1?d.25?2",
            "01234,012345,123456789,?d.25?2.2?1?d.?3?d",
            "01234,012345,123456789,?d.25?2.2?1?d.?d",
            "01234,012345,123456789,?d.25?2.25?2.1?d?d",
            "01234,012345,123456789,?d.25?2.25?2.2?1?d",
            "01234,012345,123456789,?d.25?2.25?2.25?2",
            "01234,012345,123456789,?d.25?2.25?2.?3?d",
            "01234,012345,123456789,?d.25?2.25?2.?d",
            "01234,012345,123456789,?d.25?2.?3?d.1?d?d",
            "01234,012345,123456789,?d.25?2.?3?d.2?1?d",
            "01234,012345,123456789,?d.25?2.?3?d.25?2",
            "01234,012345,123456789,?d.25?2.?3?d.?3?d",
            "01234,012345,123456789,?d.25?2.?3?d.?d",
            "01234,012345,123456789,?d.25?2.?d.1?d?d",
            "01234,012345,123456789,?d.25?2.?d.2?1?d",
            "01234,012345,123456789,?d.25?2.?d.25?2",
            "01234,012345,123456789,?d.25?2.?d.?3?d",
            "01234,012345,123456789,?d.25?2.?d.?d",
            "01234,012345,123456789,?d.?3?d.1?d?d.1?d?d",
            "01234,012345,123456789,?d.?3?d.1?d?d.2?1?d",
            "01234,012345,123456789,?d.?3?d.1?d?d.25?2",
            "01234,012345,123456789,?d.?3?d.1?d?d.?3?d",
            "01234,012345,123456789,?d.?3?d.1?d?d.?d",
            "01234,012345,123456789,?d.?3?d.2?1?d.1?d?d",
            "01234,012345,123456789,?d.?3?d.2?1?d.2?1?d",
            "01234,012345,123456789,?d.?3?d.2?1?d.25?2",
            "01234,012345,123456789,?d.?3?d.2?1?d.?3?d",
            "01234,012345,123456789,?d.?3?d.2?1?d.?d",
            "01234,012345,123456789,?d.?3?d.25?2.1?d?d",
            "01234,012345,123456789,?d.?3?d.25?2.2?1?d",
            "01234,012345,123456789,?d.?3?d.25?2.25?2",
            "01234,012345,123456789,?d.?3?d.25?2.?3?d",
            "01234,012345,123456789,?d.?3?d.25?2.?d",
            "01234,012345,123456789,?d.?3?d.?3?d.1?d?d",
            "01234,012345,123456789,?d.?3?d.?3?d.2?1?d",
            "01234,012345,123456789,?d.?3?d.?3?d.25?2",
            "01234,012345,123456789,?d.?3?d.?3?d.?3?d",
            "01234,012345,123456789,?d.?3?d.?3?d.?d",
            "01234,012345,123456789,?d.?3?d.?d.1?d?d",
            "01234,012345,123456789,?d.?3?d.?d.2?1?d",
            "01234,012345,123456789,?d.?3?d.?d.25?2",
            "01234,012345,123456789,?d.?3?d.?d.?3?d",
            "01234,012345,123456789,?d.?3?d.?d.?d",
            "01234,012345,123456789,?d.?d.1?d?d.1?d?d",
            "01234,012345,123456789,?d.?d.1?d?d.2?1?d",
            "01234,012345,123456789,?d.?d.1?d?d.25?2",
            "01234,012345,123456789,?d.?d.1?d?d.?3?d",
            "01234,012345,123456789,?d.?d.1?d?d.?d",
            "01234,012345,123456789,?d.?d.2?1?d.1?d?d",
            "01234,012345,123456789,?d.?d.2?1?d.2?1?d",
            "01234,012345,123456789,?d.?d.2?1?d.25?2",
            "01234,012345,123456789,?d.?d.2?1?d.?3?d",
            "01234,012345,123456789,?d.?d.2?1?d.?d",
            "01234,012345,123456789,?d.?d.25?2.1?d?d",
            "01234,012345,123456789,?d.?d.25?2.2?1?d",
            "01234,012345,123456789,?d.?d.25?2.25?2",
            "01234,012345,123456789,?d.?d.25?2.?3?d",
            "01234,012345,123456789,?d.?d.25?2.?d",
            "01234,012345,123456789,?d.?d.?3?d.1?d?d",
            "01234,012345,123456789,?d.?d.?3?d.2?1?d",
            "01234,012345,123456789,?d.?d.?3?d.25?2",
            "01234,012345,123456789,?d.?d.?3?d.?3?d",
            "01234,012345,123456789,?d.?d.?3?d.?d",
            "01234,012345,123456789,?d.?d.?d.1?d?d",
            "01234,012345,123456789,?d.?d.?d.2?1?d",
            "01234,012345,123456789,?d.?d.?d.25?2",
            "01234,012345,123456789,?d.?d.?d.?3?d",
            "01234,012345,123456789,?d.?d.?d.?d"
        };

        File.WriteAllLines(this.maskPatternsPath, patterns);
    }

    public async Task<string> CrackHashAsync(string hash)
    {
        string? result = null;

        var startInfo = new ProcessStartInfo
        {
            FileName = this.hashcatExecutablePath,
            Arguments = $"-m 0 -d 1 -a 3 {hash} -w 3 {this.maskPatternsPath} --potfile-path {this.potfilePath}",
            UseShellExecute = false,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            CreateNoWindow = true,
            WorkingDirectory = this.hashcatDir
        };

        hashcatProcess = new Process { StartInfo = startInfo };
        hashcatProcess.Start();

        hashcatProcess.BeginOutputReadLine();
        hashcatProcess.OutputDataReceived += (sender, args) =>
        {
            Console.WriteLine(args.Data);
            if (args.Data != null)
            {
                if (args.Data.Contains("Status...........: Cracked") ||
                    args.Data.Contains("Recovered........: 1/1 (100.00%)") ||
                    (args.Data.Contains("Guess.Queue") && args.Data.Contains("100.00%")))
                {
                    if (!hashcatProcess.HasExited)
                    {
                        hashcatProcess.Kill();
                    }
                }
            }
        };

        hashcatProcess.BeginErrorReadLine();
        hashcatProcess.ErrorDataReceived += (sender, args) => Console.WriteLine(args.Data);

        hashcatProcess.WaitForExit();

        // After hashcat finishes, check the potfile for the hash and its corresponding plaintext
        if (File.Exists(this.potfilePath))
        {
            var potfileContents = await File.ReadAllLinesAsync(this.potfilePath);
            foreach (var line in potfileContents)
            {
                if (line.Contains(hash))
                {
                    result = line.Split(':')[1];
                    break;
                }
            }
        }

        if (File.Exists(this.maskPatternsPath))
        {
            File.Delete(this.maskPatternsPath);
        }

#pragma warning disable CS8603 // Possible null reference return.
        return result;
#pragma warning restore CS8603 // Possible null reference return.
    }
}